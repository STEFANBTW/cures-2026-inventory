const navbar=document.getElementById("navbar");let lastScrollTop=0;let isFilterScroll=false;window.addEventListener("scroll",function(){if(isFilterScroll)return;let scrollTop=window.pageYOffset||document.documentElement.scrollTop;const stc=document.getElementById("stc");if(scrollTop>lastScrollTop&&scrollTop>100){navbar.classList.add("nav-hidden");if(stc)stc.style.top="0px";}else{navbar.classList.remove("nav-hidden");if(stc){if(window.innerWidth<=740){stc.style.top=(navbar.getBoundingClientRect().height)+"px";}else{stc.style.top="70px";}}}
lastScrollTop=scrollTop;});const navDropdown=document.querySelector('.nav-dropdown');const dropdownContent=document.querySelector('.dropdown-content');const dropBtn=document.querySelector('.dropbtn');let dropdownTimeout;navDropdown.addEventListener('mouseenter',()=>{if(window.innerWidth>1200){clearTimeout(dropdownTimeout);dropdownContent.classList.add('show');}});navDropdown.addEventListener('mouseleave',()=>{if(window.innerWidth>1200){dropdownTimeout=setTimeout(()=>{dropdownContent.classList.remove('show');},300);}});if(dropBtn){dropBtn.addEventListener('click',(e)=>{if(window.innerWidth<=1200){if(!dropdownContent.classList.contains('show')){e.preventDefault();dropdownContent.classList.add('show');}}});}
document.addEventListener('click',(e)=>{if(!navDropdown.contains(e.target)){clearTimeout(dropdownTimeout);dropdownContent.classList.remove('show');}
if(!navbar.contains(e.target)){navbar.classList.add('nav-hidden');const stc=document.getElementById("stc");if(stc)stc.style.top="0px";}});window.addEventListener('resize',()=>{const stc=document.getElementById("stc");if(stc&&!navbar.classList.contains("nav-hidden")){if(window.innerWidth<=740){stc.style.top=(navbar.getBoundingClientRect().height)+"px";}else{stc.style.top="70px";}}});const currencyState={current:'NGN',rates:{NGN:1,EUR:0.00061},symbols:{NGN:'₦',EUR:'€'}};let searchTerm='';let fullGrandTotal=0;function assignEssentialCategories(){if(typeof inventory==='undefined')return;inventory.forEach(item=>{if(item.essentialRank!==undefined&&item.essentialRank!==null){switch(item.essentialRank){case 0:item.essentialCategory='Optional';break;case 1:item.essentialCategory='Critical';break;case 2:item.essentialCategory='Professional/Important';break;case 3:item.essentialCategory='Expansion/Student';break;case 4:item.essentialCategory='Infrastructure';break;case 5:item.essentialCategory='Accessories';break;}}});}
function getFormattedPrice(rawPrice){const{current,rates,symbols}=currencyState;const displayPrice=rawPrice*rates[current];const symbol=symbols[current];const formatted=displayPrice.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2});return`${symbol}${formatted}`;}
function parsePrice(v){if(v===undefined||v===null)return 0;if(typeof v==='number')return v;if(typeof v==='string'){if(/free/i.test(v))return 0;const m=v.match(/[-+]?[0-9]{1,3}(?:[0-9,]*)(?:\.[0-9]+)?|[-+]?[0-9]+(?:\.[0-9]+)?/);if(m){const num=m[0].replace(/,/g,'');const n=Number(num);return Number.isFinite(n)?n:0;}
return 0;}
const n=Number(v);return Number.isFinite(n)?n:0;}
function updateAllPrices(){const symbol=currencyState.symbols[currencyState.current];document.querySelectorAll('.currency-symbol').forEach(el=>el.textContent=symbol);renderProspects();sortSummary();document.getElementById('grand-total-display').textContent=getFormattedPrice(fullGrandTotal);document.getElementById('sticky-grand-total').textContent=getFormattedPrice(fullGrandTotal);document.getElementById('mobile-grand-total').textContent=getFormattedPrice(fullGrandTotal);}
function renderProspects(){const categories={'Learning':document.getElementById('grid-learning'),'Repair':document.getElementById('grid-repair'),'Productivity':document.getElementById('grid-productivity')};const counts={'Learning':0,'Repair':0,'Productivity':0};const totals={'Learning':{base:0,shipping:0},'Repair':{base:0,shipping:0},'Productivity':{base:0,shipping:0}};const fragments={};for(let key in categories){if(categories[key]){categories[key].innerHTML='';fragments[key]=document.createDocumentFragment();}}
inventory.forEach((item,index)=>{const container=categories[item.category];if(container){if(counts.hasOwnProperty(item.category)){counts[item.category]++;}
if(totals.hasOwnProperty(item.category)){totals[item.category].base+=parsePrice(item.basePrice)*(item.quantity||1);totals[item.category].shipping+=parsePrice(item.shipping)*(item.quantity||1);}
const metaRowClass=(item.category==='Productivity'&&item.isEssential)?'productivity-essential':'';let badgeHtml='';if(item.essentialRank===1){badgeHtml=`<div class="essential-badge">ESSENTIAL<span class="badge-rank-number">${item.essentialRank}</span></div>`;}else if(item.essentialRank>1){badgeHtml=`<div class="rank-badge">RANK<span class="badge-rank-number">${item.essentialRank}</span></div>`;}
const cardWrapper=document.createElement('div');cardWrapper.className='tool-card-wrapper';const card=document.createElement('div');card.className='tool-card';card.style.animationDelay=`${index*0.05}s`;card.setAttribute('data-item-id',item.id);const imagesList=item.images&&item.images.length>0?item.images:["https://placehold.co/300x200?text=No+Img"];const thumbnailImagesList=imagesList.map(src=>{const lastDot=src.lastIndexOf('.');if(lastDot!==-1){return src.substring(0,lastDot)+'_thumb'+src.substring(lastDot);}
return src;});const sliderHTML=thumbnailImagesList.map(src=>`<img loading="lazy"decoding="async"src="${src}"alt="${item.name}"onerror="this.src='https://placehold.co/300x200?text=No+Image'">`).join('');card.innerHTML=`<div class="tool-pics-container"><div class="slider-frame"><div class="slider-track">${sliderHTML}</div></div></div><div class="tool-card-body"><div class="tool-meta-row ${metaRowClass}"><span class="card-category">${item.category}</span>${badgeHtml}</div><h1 class="tool-name"title="${item.name}">${item.nickname||item.name}</h1><h5 class="tool-store">${item.productStore||''}</h5><h1 class="tool-price"data-base-price-ngn="${parsePrice(item.basePrice)}">${getFormattedPrice(parsePrice(item.basePrice))}</h1><a href="${item.productLink || '#'}"target="_blank"class="go-to-page"><span>Go to page</span></a></div>`;card.addEventListener('click',handleCardClick);cardWrapper.appendChild(card);fragments[item.category].appendChild(cardWrapper);}});for(let key in categories){if(categories[key]&&fragments[key])categories[key].appendChild(fragments[key]);}
document.getElementById('learning-count').textContent=counts['Learning'];document.getElementById('repair-count').textContent=counts['Repair'];document.getElementById('productivity-count').textContent=counts['Productivity'];const categoriesForTotals=['Learning','Repair','Productivity'];categoriesForTotals.forEach(cat=>{const catKey=cat.toLowerCase();const catTotals=totals[cat];const basePriceEl=document.getElementById(`${catKey}-total-price`);const shippingEl=document.getElementById(`${catKey}-total-shipping`);const totalPlusEl=document.getElementById(`${catKey}-total-plus`);if(basePriceEl&&shippingEl&&totalPlusEl){basePriceEl.textContent=getFormattedPrice(catTotals.base).substring(1);shippingEl.textContent=getFormattedPrice(catTotals.shipping).substring(1);totalPlusEl.textContent=getFormattedPrice(catTotals.base+catTotals.shipping).substring(1);}});}
function handleCardClick(e){if(e.target.closest('.go-to-page')){return;}
const card=e.currentTarget;const gridContainer=card.closest('.tool-bag-grid-container');const itemId=parseInt(card.dataset.itemId,10);const item=inventory.find(i=>i.id===itemId);if(!item)return;const existingPanel=gridContainer.querySelector('.tool-bag-tdescr');if(existingPanel){existingPanel.remove();}
const specsList=Array.isArray(item.brief)?item.brief:(item.brief?item.brief.split('\n'):[]);const specsHTML=specsList.length>0?specsList.map(s=>`<li>${s}</li>`).join(''):'<li>N/A</li>';const panelSliderHTML=(item.images||[]).map(src=>`<img loading="lazy"decoding="async"src="${src}"alt="${item.name}">`).join('');const shippingText=parsePrice(item.shipping)>0?`+${getFormattedPrice(parsePrice(item.shipping))}shipping`:'Free shipping';let badgeHtml='';if(item.essentialRank===1){badgeHtml=`<div class="essential-badge">ESSENTIAL<span class="panel-badge-rank">${item.essentialRank}</span></div>`;}else if(item.essentialRank>1){badgeHtml=`<div class="rank-badge">RANK<span class="panel-badge-rank">${item.essentialRank}</span></div>`;}
const rankInfoHTML=item.essentialCategory?`<div class="panel-rank-info"><span class="panel-rank-label">Rank</span><span class="panel-rank-category">${item.essentialCategory}</span><span class="panel-rank-circle">${item.essentialRank}</span></div>`:'';const variationHTML=item.variation?`<div class="panel-variation"style="margin-bottom: 10px; font-size: 0.95em; color: aliceblue;"><strong>Variation:</strong>${item.variation}</div>`:'';const usageHTML=item.usage?`<h3 class="detail-section-title">Usage</h3><p>${item.usage}</p>`:'';let dealBadgeHtml='';if(item.dealTag&&item.dealTag!=='None'){if(item.dealTag.startsWith('http')){dealBadgeHtml=`<img src="${item.dealTag}"class="deal-badge-img"alt="Deal Badge">`;}else{let badgeClass='deal-official';if(item.dealTag==='Choice')badgeClass='deal-choice';else if(item.dealTag==='Jumia Express')badgeClass='deal-express';else if(item.dealTag==='SuperDeals')badgeClass='deal-super';dealBadgeHtml=`<span class="deal-badge ${badgeClass}">${item.dealTag}</span>`;}}
const sourceHTML=`<div class="panel-source-row"><span class="panel-source-label">Source:</span><span class="panel-source-name">${item.source||'Unknown'}</span>${dealBadgeHtml}</div>`;const visitButtonHTML=item.productLink?`<a href="${item.productLink}"target="_blank"class="panel-visit-btn">Visit Store Page</a>`:'';const panelHTML=`<div class="tool-bag-tdescr"><button class="panel-close-btn">&times;</button><div class="panel-header"><h2 class="panel-name">${item.name}</h2><p class="panel-store-prefix">From ${item.productStore||''}</p><div class="panel-subheader"><div class="panel-price">${getFormattedPrice(parsePrice(item.basePrice))}<small>${shippingText}</small></div></div></div><div class="panel-slider"><div class="slider-frame"><div class="slider-track">${panelSliderHTML}</div><div class="panel-meta-row"><span class="card-category">${item.category}</span>${badgeHtml}</div><div class="slider-controls"><button class="slider-btn prev-btn">&#10094;</button><button class="slider-btn next-btn">&#10095;</button></div></div></div><div class="panel-details">${rankInfoHTML}
${variationHTML}
${usageHTML}<h3 class="detail-section-title">Specifications</h3><ul class="detail-specs-list">${specsHTML}</ul><h3 class="detail-section-title">Description</h3><p>${item.description}</p>${sourceHTML}
${visitButtonHTML}</div><p class="close-panel-hint">Click anywhere outside to close</p></div>`;gridContainer.insertAdjacentHTML('beforeend',panelHTML);const newPanel=gridContainer.querySelector('.tool-bag-tdescr:last-child');const closeBtn=newPanel.querySelector('.panel-close-btn');if(closeBtn){closeBtn.addEventListener('click',()=>{const intervalId=newPanel.dataset.sliderIntervalId;if(intervalId)clearInterval(parseInt(intervalId,10));newPanel.classList.remove('is-visible');newPanel.addEventListener('transitionend',()=>newPanel.remove(),{once:true});});}
requestAnimationFrame(()=>{if(newPanel){newPanel.classList.add('is-visible');initPanelSlider(newPanel);}});}
function initPanelSlider(panelElement){const track=panelElement.querySelector('.slider-track');if(!track)return;const images=track.querySelectorAll('img');let zoomedImg=null;track.addEventListener('mousemove',(e)=>{if(e.target.tagName==='IMG'){const img=e.target;if(zoomedImg&&zoomedImg!==img){zoomedImg.style.transform="scale(1)";zoomedImg.style.transformOrigin="center center";}
zoomedImg=img;const rect=img.getBoundingClientRect();const x=e.clientX-rect.left;const y=e.clientY-rect.top;const xPercent=(x/rect.width)*100;const yPercent=(y/rect.height)*100;img.style.transformOrigin=`${xPercent}%${yPercent}%`;img.style.transform="scale(2)";}});track.addEventListener('mouseleave',()=>{if(zoomedImg){zoomedImg.style.transform="scale(1)";zoomedImg.style.transformOrigin="center center";zoomedImg=null;}});if(images.length<=1){const controls=panelElement.querySelector('.slider-controls');if(controls)controls.style.display='none';return;}
let currentIndex=0;const totalSlides=images.length;let intervalId;const updateSlide=()=>{track.style.transform=`translateX(-${currentIndex*100}%)`;};const startAutoSlide=()=>{if(intervalId)clearInterval(intervalId);intervalId=setInterval(()=>{currentIndex=(currentIndex+1)%totalSlides;updateSlide();},4000);};const prevBtn=panelElement.querySelector('.prev-btn');const nextBtn=panelElement.querySelector('.next-btn');if(prevBtn)prevBtn.addEventListener('click',(e)=>{e.stopPropagation();currentIndex=(currentIndex-1+totalSlides)%totalSlides;updateSlide();startAutoSlide();});if(nextBtn)nextBtn.addEventListener('click',(e)=>{e.stopPropagation();currentIndex=(currentIndex+1)%totalSlides;updateSlide();startAutoSlide();});track.addEventListener('mouseenter',()=>{if(intervalId)clearInterval(intervalId);});track.addEventListener('mouseleave',()=>{startAutoSlide();});startAutoSlide();panelElement.dataset.sliderIntervalId=intervalId;}
const pdfBtn=document.querySelector('.dld-pdf');if(pdfBtn){pdfBtn.addEventListener('click',()=>{if(!window.jspdf){alert("PDF Library not loaded. Check internet connection.");return;}
const{jsPDF}=window.jspdf;const originalText=pdfBtn.querySelector('h1').innerText;pdfBtn.querySelector('h1').innerText="Generating PDF...";try{const doc=new jsPDF({format:'a4'});const pageWidth=doc.internal.pageSize.width;const pageHeight=doc.internal.pageSize.height;const margin=10;let yPos=10;const imageSize=15;const textStartX=margin+imageSize+5;const maxNameWidth=pageWidth-textStartX-margin-45;const getPdfPrice=(rawPrice)=>{const{current,rates}=currencyState;const displayPrice=rawPrice*rates[current];const formatted=displayPrice.toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2});return`${current}${formatted}`;};const grandTotal=inventory.reduce((sum,i)=>sum+((parsePrice(i.basePrice)+parsePrice(i.shipping))*(i.quantity||1)),0);const totalBasePrice=inventory.reduce((sum,i)=>sum+(parsePrice(i.basePrice)*(i.quantity||1)),0);const totalShipping=inventory.reduce((sum,i)=>sum+(parsePrice(i.shipping)*(i.quantity||1)),0);const categories={};inventory.forEach(item=>{if(!categories[item.category])categories[item.category]=[];categories[item.category].push(item);});doc.setFont("helvetica","bold");doc.setFontSize(16);doc.setTextColor(40,40,40);doc.text("CURE PROSPECTS 2025-2026",margin,yPos+6);doc.setFontSize(18);doc.setTextColor(0,0,0);doc.text(getPdfPrice(grandTotal),pageWidth-margin,yPos+6,{align:"right"});yPos+=12;doc.setFont("helvetica","normal");doc.setFontSize(9);doc.setTextColor(100,100,100);const totalBreakdownText=`Products:${getPdfPrice(totalBasePrice)}+Shipping:${getPdfPrice(totalShipping)}`;doc.text(totalBreakdownText,pageWidth-margin,yPos,{align:"right"});yPos+=5;doc.setDrawColor(200,200,200);doc.setLineWidth(0.5);doc.line(margin,yPos,pageWidth-margin,yPos);yPos+=10;const categoryOrder=['Learning','Repair','Productivity'];categoryOrder.forEach(catName=>{if(!categories[catName])return;const items=categories[catName];if(yPos>pageHeight-margin-20){doc.addPage();yPos=margin+10;}
doc.setFont("helvetica","bold");doc.setFontSize(14);doc.setTextColor(0,51,102);doc.text(catName.toUpperCase(),margin,yPos);yPos+=10;items.forEach(item=>{const quantity=item.quantity||1;const unitBase=parsePrice(item.basePrice);const unitShip=parsePrice(item.shipping||0);const totalCost=(unitBase+unitShip)*quantity;let breakdownText=`Qty:${quantity}|Base:${getPdfPrice(unitBase)}`;if(unitShip>0){breakdownText+=`|Ship:${getPdfPrice(unitShip)}`;}else{breakdownText+=`|Free Ship`;}
const rowHeight=25;if(yPos+rowHeight>pageHeight-margin){doc.addPage();yPos=margin+10;}
doc.setFillColor(240,240,240);doc.rect(margin,yPos,imageSize,imageSize,'F');doc.setFontSize(6);doc.setTextColor(150,150,150);doc.text("IMG",margin+4,yPos+9);doc.setFont("helvetica","bold");doc.setFontSize(12);doc.setTextColor(0,0,0);let nameLines=doc.splitTextToSize(item.nickname||item.name,maxNameWidth);if(nameLines.length>2){let secondLine=nameLines[1];if(secondLine.length>3){secondLine=secondLine.substring(0,secondLine.length-3)+"...";}
nameLines=[nameLines[0],secondLine];}
doc.text(nameLines,textStartX,yPos+5);const detailYOffset=nameLines.length>1?11+5:11;doc.setFont("helvetica","normal");doc.setFontSize(10);doc.setTextColor(80,80,80);doc.text(`${item.productStore}|${item.source}`,textStartX,yPos+detailYOffset);doc.setFont("helvetica","bold");doc.setFontSize(12);doc.setTextColor(0,0,0);doc.text(getPdfPrice(totalCost),pageWidth-margin,yPos+5,{align:"right"});doc.setFont("helvetica","italic");doc.setFontSize(8);doc.setTextColor(120,120,120);doc.text(breakdownText,pageWidth-margin,yPos+11,{align:"right"});yPos+=rowHeight;doc.setDrawColor(230,230,230);doc.line(margin,yPos-8,pageWidth-margin,yPos-8);});yPos+=5;});doc.save('CURE_Prospects_2025-2026_Inventory.pdf');}catch(err){console.error(err);alert("Error generating PDF. See console for details.");}finally{pdfBtn.querySelector('h1').innerText=originalText;}});}
document.addEventListener('DOMContentLoaded',()=>{assignEssentialCategories();const totalGrandTotal=inventory.reduce((sum,item)=>sum+((parsePrice(item.basePrice)+parsePrice(item.shipping||0))*(item.quantity||1)),0);document.getElementById('grand-total-display').textContent=getFormattedPrice(totalGrandTotal);document.getElementById('sticky-grand-total').textContent=getFormattedPrice(totalGrandTotal);document.getElementById('mobile-grand-total').textContent=getFormattedPrice(totalGrandTotal);renderProspects();const toolBagNav=document.querySelector('.tool-bag-nav');if(toolBagNav){toolBagNav.addEventListener('click',(e)=>{if(!toolBagNav.classList.contains('active')){e.preventDefault();toolBagNav.classList.add('active');}});document.addEventListener('click',(e)=>{if(!toolBagNav.contains(e.target)){toolBagNav.classList.remove('active');}});}
const briefHeaders=document.querySelectorAll('.tool-bag-brief-brief h1');briefHeaders.forEach(header=>{header.addEventListener('click',()=>{if(window.innerWidth<=1200){const group=header.closest('.tools-group');if(group){const gridContainer=group.querySelector('.tool-bag-grid-container');if(gridContainer){gridContainer.scrollIntoView({behavior:'smooth',block:'start'});}}}});});const fontToggleBtn=document.getElementById('font-toggle-btn');const savedFontPref=localStorage.getItem('fontPreference');if(savedFontPref==='large'){document.body.classList.add('large-font');}
if(fontToggleBtn){fontToggleBtn.addEventListener('click',(e)=>{e.preventDefault();document.body.classList.toggle('large-font');const isLarge=document.body.classList.contains('large-font');localStorage.setItem('fontPreference',isLarge?'large':'normal');});}
const searchBar=document.getElementById('search-bar');searchBar.addEventListener('input',(e)=>{searchTerm=e.target.value.toLowerCase();sortSummary();});const currencyBtns=[document.getElementById('currency-toggle-btn'),document.getElementById('currency-toggle-btn2'),document.getElementById('currency-toggle-btn2'),document.getElementById('mobile-currency-btn')].filter(btn=>btn);function toggleCurrency(){if(currencyState.current==='NGN')currencyState.current='EUR';else currencyState.current='NGN';const nextCurrency=currencyState.current==='NGN'?'EUR':'NGN';currencyBtns.forEach(btn=>{const textSpan=btn.querySelector('.link-descr');if(textSpan){textSpan.textContent=`Switch to ${nextCurrency}`;}else{btn.textContent=`Switch to ${nextCurrency}`;}});updateAllPrices();}
currencyBtns.forEach(btn=>btn.addEventListener('click',toggleCurrency));document.addEventListener('click',function(event){const openPanel=document.querySelector('.tool-bag-tdescr.is-visible');if(!openPanel)return;const isClickOnToolCard=event.target.closest('.tool-card');const isClickInsidePanel=openPanel.contains(event.target);if(!isClickInsidePanel&&!isClickOnToolCard){const intervalId=openPanel.dataset.sliderIntervalId;if(intervalId){clearInterval(parseInt(intervalId,10));}
openPanel.classList.remove('is-visible');openPanel.addEventListener('transitionend',()=>openPanel.remove(),{once:true});}});const dropdownLinks=document.querySelectorAll('.dropdown-content a');const toolBagSection=document.getElementById('prospects');const toolBagContainer=document.querySelector('.tool-bag');dropdownLinks.forEach(link=>{link.addEventListener('click',(e)=>{e.preventDefault();const href=link.getAttribute('href');const targetId=href?href.substring(1):null;const targetGroup=document.getElementById(targetId);if(targetGroup&&toolBagContainer&&toolBagSection){toolBagSection.scrollIntoView({behavior:'smooth',block:'start'});setTimeout(()=>{const scrollPos=targetGroup.offsetLeft-(window.innerWidth*0.05);toolBagContainer.scrollTo({left:scrollPos,behavior:'smooth'});},600);}});});const searchIconBtn=document.getElementById('search-icon-btn');const searchInput=document.getElementById('search-bar');const filterHamBtn=document.getElementById('filter-hamburger-btn');const filterContainer=document.querySelector('.summary-filter-container');if(searchIconBtn&&searchInput){searchIconBtn.addEventListener('click',(e)=>{e.stopPropagation();searchInput.classList.add('expanded');searchIconBtn.classList.add('hide-anim');searchInput.focus();});document.addEventListener('click',(e)=>{if(!searchInput.contains(e.target)&&!searchIconBtn.contains(e.target)){searchInput.classList.remove('expanded');searchIconBtn.classList.remove('hide-anim');}});}
if(filterHamBtn&&filterContainer){filterHamBtn.addEventListener('click',()=>{const isNowOpen=filterContainer.classList.toggle('show');document.querySelector('.utility-top-row').classList.toggle('filters-expanded',isNowOpen);if(!isNowOpen){lastScrollTop=0;}});document.addEventListener('click',(e)=>{if(filterContainer.classList.contains('show')&&!filterContainer.contains(e.target)&&!filterHamBtn.contains(e.target)){filterContainer.classList.remove('show');document.querySelector('.utility-top-row').classList.remove('filters-expanded');lastScrollTop=0;}});}
let summaryLoaded=false;const summaryHeader=document.getElementById('summary-header');console.log('Summary header element:',summaryHeader);if(summaryHeader){const summaryObserver=new IntersectionObserver((entries)=>{entries.forEach(entry=>{console.log('Summary header visibility:',entry.isIntersecting);if(entry.isIntersecting&&!summaryLoaded){summaryLoaded=true;console.log('Loading summary.min.js...');const summaryScript=document.createElement('script');summaryScript.src='summary.min.js';summaryScript.onload=()=>{console.log('Summary.js loaded successfully');fullGrandTotal=inventory.reduce((sum,item)=>sum+((parsePrice(item.basePrice)+parsePrice(item.shipping||0))*(item.quantity||1)),0);console.log('Calling renderSummary with inventory:',inventory.length,'items');renderSummary(inventory);summaryObserver.unobserve(summaryHeader);};summaryScript.onerror=()=>{console.error('Failed to load summary.js');};document.body.appendChild(summaryScript);}});},{threshold:0.01});summaryObserver.observe(summaryHeader);}else{console.warn('Summary header element not found!');}});